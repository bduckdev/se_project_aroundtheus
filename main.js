!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),n=(document.querySelector("#profile-name"),document.querySelector("#profile-description"),document.querySelector("#profile-name-input")),r=document.querySelector("#profile-description-input"),s=document.querySelector(".profile__add-button"),i=document.querySelector("#add-card-modal");document.querySelector("#add-card-title-input"),document.querySelector("#add-card-image-input"),document.querySelector("#view-image-modal"),document.querySelector("#image-modal-text"),document.querySelector("#image-modal-image"),document.querySelectorAll(".modal"),document.querySelectorAll("form"),document.querySelector(".gallery__container");class a{constructor(e,t,o){let{name:n,link:r}=e;this._name=n,this._link=r,this._cardSelector=t,this._handleImageClick=o}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButton()})),this.cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this)}))}_handleLikeButton(){this._likeButton.classList.toggle("card__button_active")}_handleDeleteButton(){this._cardEl.remove(),this._cardEl=null}getView(){return this._cardEl=document.querySelector(this._cardSelector).content.cloneNode(!0).querySelector(".card"),this.cardImageEl=this._cardEl.querySelector("#card-image"),this.cardTitleEl=this._cardEl.querySelector("#card-title"),this._likeButton=this._cardEl.querySelector("#card-button"),this._deleteButton=this._cardEl.querySelector("#card-delete"),this.cardTitleEl.innerText=this._name,this.cardImageEl.src=this._link,this.cardImageEl.alt=this._name,this._setEventListeners(),this._cardEl}}class l{constructor(e,t){this._config=e,this._targetForm=t}_showInputError(e){const t=this._targetForm.querySelector(`#${e.id}-error`);e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._targetForm.querySelector(`#${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.textContent="",t.classList.remove(this._config.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e,t){let o=!1;e.forEach((e=>{e.validity.valid||(o=!0)})),o?this.disableSubmitButton():(t.classList.remove(this._config.inactiveButtonClass),t.disabled=!1)}_setEventListeners(){const e=this._config.inputSelector,t=[...this._targetForm.querySelectorAll(e)],o=this._targetForm.querySelector(this._config.submitButtonSelector);this._toggleButtonState(t,o),t.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(t,o)}))}))}enableValidation(){this._targetForm.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._targetForm)}disableSubmitButton(){const e=this._targetForm.querySelector(this._config.submitButtonSelector);e.classList.add(this._config.inactiveButtonClass),e.disabled=!0}}class c{constructor(e){let{modalSelector:t}=e;this._modalElement=document.querySelector(t)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleCloseClick=e=>{e.target.classList.contains("modal_opened")&&this.close(),e.target.classList.contains("modal__close")&&this.close()};_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.addEventListener("click",this._handleCloseClick)}}class d extends c{constructor(e){let{modalSelector:t,handleFormSubmit:o}=e;super({modalSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=o}_getInputValues(){const e=[...this._modalForm.querySelectorAll(".modal__input")],t={};return e.forEach((e=>{const o=e.name,n=e.value;t[o]=n})),t}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{const t=this._getInputValues();this._handleFormSubmit(e,t),this.close()})),super.setEventListeners()}close(){this._modalForm.reset(),super.close()}}const m=new d({modalSelector:"#profile-edit-modal",handleFormSubmit:function(e,t){e.preventDefault();const o=t.Name,n=t.Description;_.setUserInfo(o,n),E.disableSubmitButton()}}),u=new d({modalSelector:"#add-card-modal",handleFormSubmit:function(e,t){e.preventDefault();const o=g({name:t.Title,link:t["Image Link"]});y.addItem(o),S.disableSubmitButton()}}),h=new class extends c{constructor(e){let{modalSelector:t}=e;super({modalSelector:t}),this._image=document.querySelector("#image-modal-image"),this._caption=document.querySelector("#image-modal-text")}open(e){this._image.src=e.cardImageEl.src,this._image.alt=e.cardImageEl.alt,this._caption.textContent=e.cardTitleEl.textContent,super.open()}}({modalSelector:"#view-image-modal"}),_=new class{constructor(e){let{nameSelector:t,descriptionSelector:o}=e;this.nameEl=document.querySelector(t),this.descriptionEl=document.querySelector(o)}getUserInfo(){return{name:this.nameEl.innerText,description:this.descriptionEl.innerText}}setUserInfo(e,t){this.nameEl.textContent=e,this.descriptionEl.textContent=t}}({nameSelector:"#profile-name",descriptionSelector:"#profile-description"});function p(e){h.open(e)}function g(e){let{name:t,link:o}=e;return new a({name:t,link:o},"#card-template",p).getView()}t.addEventListener("click",(()=>{m.open();const e=_.getUserInfo();n.value=e.name,r.value=e.description})),s.addEventListener("click",(()=>{u.open()}));const S=new l(e,i);S.enableValidation();const E=new l(e,o);E.enableValidation(),u.setEventListeners(),m.setEventListeners(),h.setEventListeners();const y=new class{constructor(e,t){let{items:o,renderer:n}=e;this.items=o,this.renderer=n,this.selector=t}addItem(e){document.querySelector(this.selector).prepend(e)}renderItems(){this.items.forEach((e=>{const t=this.renderer(e);this.addItem(t)}))}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:g},"#gallery-container");y.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxJQUNsQixNQUFNSCxFQUFLakcsS0FBS2dHLFNBQVNJLEdBQ3pCcEcsS0FBS2lGLFFBQVFnQixFQUFHLEdBRXBCLEdIK0VBLENBQUVGLE1MN0Z3QixDQUMxQixDQUNFakcsS0FBTSxrQkFDTkMsS0FBTSxzR0FFUixDQUNFRCxLQUFNLGNBQ05DLEtBQU0seUdBRVIsQ0FDRUQsS0FBTSxpQkFDTkMsS0FBTSw0R0FFUixDQUNFRCxLQUFNLFVBQ05DLEtBQU0scUdBRVIsQ0FDRUQsS0FBTSx3QkFDTkMsS0FBTSxxR0FFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLG1HS3NFc0JpRyxTQUFVakIsR0FDeEMsc0JBR0ZDLEVBQVFtQixhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL01vZGFsLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aEltYWdlLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0b3JDb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLy8gRUxFTUVOVFNcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0RGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCIsXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIixcbik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbERpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLXRpdGxlLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1pbWFnZS1pbnB1dFwiKTtcblxuZXhwb3J0IGNvbnN0IGltYWdlTW9kYWxEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ZpZXctaW1hZ2UtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgaW1hZ2VNb2RhbFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLW1vZGFsLXRleHRcIik7XG5leHBvcnQgY29uc3QgaW1hZ2VNb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1tb2RhbC1pbWFnZVwiKTtcblxuZXhwb3J0IGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5cbmV4cG9ydCBjb25zdCBmb3JtRWxzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJmb3JtXCIpXTtcblxuZXhwb3J0IGNvbnN0IGdhbGxlcnlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NvbnRhaW5lclwiKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmsgfSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICB9XG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgfSk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24oKTtcbiAgICB9KTtcbiAgICB0aGlzLmNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuICB9XG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2J1dHRvbl9hY3RpdmVcIik7XG4gIH1cbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkRWwucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsID0gbnVsbDtcbiAgfVxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XG5cbiAgICB0aGlzLmNhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKTtcbiAgICB0aGlzLmNhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10aXRsZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1kZWxldGVcIik7XG4gICAgdGhpcy5jYXJkVGl0bGVFbC5pbm5lclRleHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLmNhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCB0YXJnZXRGb3JtKSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX3RhcmdldEZvcm0gPSB0YXJnZXRGb3JtO1xuICB9XG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl90YXJnZXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgLFxuICAgICk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl90YXJnZXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgLFxuICAgICk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgfVxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0RWxzLCBzdWJtaXRCdXR0b24pIHtcbiAgICBsZXQgZm91bmRJbnZhbGlkID0gZmFsc2U7XG4gICAgaW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgIGZvdW5kSW52YWxpZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGZvdW5kSW52YWxpZCkge1xuICAgICAgdGhpcy5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAvL2Rpc2FibGUgYW5kIGVuYWJsZSB0aGUgc3VibWl0IGJ1dHRvblxuICB9XG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBpbnB1dFNlbGVjdG9yID0gdGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgY29uc3QgaW5wdXRFbHMgPSBbLi4udGhpcy5fdGFyZ2V0Rm9ybS5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpXTtcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLl90YXJnZXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IsXG4gICAgKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dEVscywgc3VibWl0QnV0dG9uKTtcblxuICAgIGlucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dEVscywgc3VibWl0QnV0dG9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdGFyZ2V0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnModGhpcy5fdGFyZ2V0Rm9ybSk7XG4gIH1cbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbigpIHtcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLl90YXJnZXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IsXG4gICAgKTtcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcih7IG1vZGFsU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gIH1cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG4gIF9oYW5kbGVDbG9zZUNsaWNrID0gKGUpID0+IHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIikpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsb3NlQ2xpY2spO1xuICB9XG59XG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoRm9ybSBleHRlbmRzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IF9tb2RhbElucHV0cyA9IFsuLi50aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgX21vZGFsSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5uYW1lO1xuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcbiAgICAgIGlucHV0VmFsdWVzW2tleV0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoZSwgaW5wdXRWYWx1ZXMpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9tb2RhbEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBjb25zdHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuLy8gbW9kYWxzXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQsXG59KTtcblxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBZGRDYXJkU3VibWl0LFxufSk7XG5cbmNvbnN0IGltYWdlTW9kYWwgPSBuZXcgTW9kYWxXaXRoSW1hZ2Uoe1xuICBtb2RhbFNlbGVjdG9yOiBcIiN2aWV3LWltYWdlLW1vZGFsXCIsXG59KTtcblxuLy8gcHJvZmlsZSBzZWN0aW9uXG5cbmNvbnN0IHByb2ZpbGVFbCA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIjcHJvZmlsZS1uYW1lXCIsXG4gIGRlc2NyaXB0aW9uU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZGVzY3JpcHRpb25cIixcbn0pO1xuXG4vLyBzdWJtaXNzaW9uIGhhbmRsZXJzXG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGUsIGlucHV0VmFsdWVzKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgbmFtZSA9IGlucHV0VmFsdWVzW1wiTmFtZVwiXTtcbiAgY29uc3QgZGVzY3JpcHRpb24gPSBpbnB1dFZhbHVlc1tcIkRlc2NyaXB0aW9uXCJdO1xuICBwcm9maWxlRWwuc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pO1xuICBwcm9maWxlRWRpdFZhbGlkYXRvci5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG59XG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGUsIGlucHV0VmFsdWVzKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgbmFtZSA9IGlucHV0VmFsdWVzW1wiVGl0bGVcIl07XG4gIGNvbnN0IGxpbmsgPSBpbnB1dFZhbHVlc1tcIkltYWdlIExpbmtcIl07XG4gIGNvbnN0IGNhcmRFbCA9IGNyZWF0ZUNhcmQoeyBuYW1lLCBsaW5rIH0pO1xuICBnYWxsZXJ5LmFkZEl0ZW0oY2FyZEVsKTtcbiAgYWRkQ2FyZFZhbGlkYXRvci5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG59XG4vLyByYW5kb20gaGFuZGxlcnNcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZCkge1xuICBpbWFnZU1vZGFsLm9wZW4oY2FyZCk7XG59XG5mdW5jdGlvbiBjcmVhdGVDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gIGNvbnN0IGNhcmRFbCA9IG5ldyBDYXJkKHsgbmFtZSwgbGluayB9LCBcIiNjYXJkLXRlbXBsYXRlXCIsIGhhbmRsZUltYWdlQ2xpY2spO1xuICByZXR1cm4gY2FyZEVsLmdldFZpZXcoKTtcbn1cbi8vIGV2ZW50IGxpc3RlbmVyc1xuXG5jb25zdHMucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZUVkaXRNb2RhbC5vcGVuKCk7XG4gIGNvbnN0IHByb2ZpbGVEYXRhID0gcHJvZmlsZUVsLmdldFVzZXJJbmZvKCk7XG4gIGNvbnN0cy5wcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZURhdGFbXCJuYW1lXCJdO1xuICBjb25zdHMucHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YVtcImRlc2NyaXB0aW9uXCJdO1xufSk7XG5cbmNvbnN0cy5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRNb2RhbC5vcGVuKCk7XG59KTtcblxuLy8gdmFsaWRhdGlvblxuXG5jb25zdCBhZGRDYXJkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGNvbnN0cy52YWxpZGF0b3JDb25maWcsXG4gIGNvbnN0cy5hZGRDYXJkTW9kYWxEaXYsXG4pO1xuXG5hZGRDYXJkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgcHJvZmlsZUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgY29uc3RzLnZhbGlkYXRvckNvbmZpZyxcbiAgY29uc3RzLnByb2ZpbGVFZGl0RGl2LFxuKTtcblxucHJvZmlsZUVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBvbiBwYWdlIGxvYWRcblxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnByb2ZpbGVFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuaW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBnYWxsZXJ5ID0gbmV3IFNlY3Rpb24oXG4gIHsgaXRlbXM6IGNvbnN0cy5pbml0aWFsQ2FyZHMsIHJlbmRlcmVyOiBjcmVhdGVDYXJkIH0sXG4gIFwiI2dhbGxlcnktY29udGFpbmVyXCIsXG4pO1xuXG5nYWxsZXJ5LnJlbmRlckl0ZW1zKCk7XG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9KSB7XG4gICAgc3VwZXIoeyBtb2RhbFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1tb2RhbC1pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1tb2RhbC10ZXh0XCIpO1xuICB9XG4gIG9wZW4oY2FyZCkge1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGNhcmQuY2FyZEltYWdlRWwuc3JjO1xuXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gY2FyZC5jYXJkSW1hZ2VFbC5hbHQ7XG5cbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gY2FyZC5jYXJkVGl0bGVFbC50ZXh0Q29udGVudDtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciB9KSB7XG4gICAgdGhpcy5uYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5kZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VyRGF0YSA9IHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZUVsLmlubmVyVGV4dCxcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uRWwuaW5uZXJUZXh0LFxuICAgIH07XG4gICAgcmV0dXJuIHVzZXJEYXRhO1xuICB9XG4gIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5uYW1lRWwudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuZGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcbiAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgfVxuICBhZGRJdGVtKGVsKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9yKS5wcmVwZW5kKGVsKTtcbiAgfVxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IGVsID0gdGhpcy5yZW5kZXJlcihpdGVtKTtcbiAgICAgIHRoaXMuYWRkSXRlbShlbCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJ2YWxpZGF0b3JDb25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInByb2ZpbGVFZGl0QnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZUVkaXREaXYiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlQWRkQnV0dG9uIiwiYWRkQ2FyZE1vZGFsRGl2IiwicXVlcnlTZWxlY3RvckFsbCIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJjYXJkSW1hZ2VFbCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9jYXJkRWwiLCJyZW1vdmUiLCJnZXRWaWV3IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsIiwiaW5uZXJUZXh0Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsInRhcmdldEZvcm0iLCJfY29uZmlnIiwiX3RhcmdldEZvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0RWxzIiwic3VibWl0QnV0dG9uIiwiZm91bmRJbnZhbGlkIiwiZm9yRWFjaCIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJNb2RhbCIsIm1vZGFsU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDbG9zZUNsaWNrIiwidGFyZ2V0IiwiY29udGFpbnMiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfbW9kYWxGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfbW9kYWxJbnB1dHMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInByb2ZpbGVFZGl0TW9kYWwiLCJkZXNjcmlwdGlvbiIsInByb2ZpbGVFbCIsInNldFVzZXJJbmZvIiwicHJvZmlsZUVkaXRWYWxpZGF0b3IiLCJhZGRDYXJkTW9kYWwiLCJjYXJkRWwiLCJjcmVhdGVDYXJkIiwiZ2FsbGVyeSIsImFkZEl0ZW0iLCJhZGRDYXJkVmFsaWRhdG9yIiwiaW1hZ2VNb2RhbCIsIl9pbWFnZSIsIl9jYXB0aW9uIiwiY2FyZCIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJuYW1lRWwiLCJkZXNjcmlwdGlvbkVsIiwiZ2V0VXNlckluZm8iLCJjb25zdHMiLCJwcm9maWxlRGF0YSIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsImVsIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSJdLCJzb3VyY2VSb290IjoiIn0=